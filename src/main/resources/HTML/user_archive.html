<!DOCTYPE html>
<HTML>
	<HEAD>
		<TITLE>ユーザー</TITLE>

		<LINK REL="stylesheet" HREF="https://cdn.rumia.me/CSS/font.css">
		<LINK REL="stylesheet" HREF="https://cdn.rumia.me/CSS/reset.css">
		<LINK REL="stylesheet" HREF="https://cdn.rumia.me/CSS/DEFAULT.css">

		<LINK REL="stylesheet" HREF="./STYLE/Main.css">
		<LINK REL="stylesheet" HREF="./STYLE/UserArchive.css">
	</HEAD>
	<BODY>
		<DIV>
			<A ID="BEFORE_ARCHIVE">←前の魚拓</A>

			<SPAN><SPAN ID="ARCHIVE_DATE"></SPAN>の魚拓</SPAN>

			<A ID="AFTER_ARCHIVE">次の魚拓→</A>
		</DIV>

		<DIV CLASS="USER">
			<DIV CLASS="HEADER" ID="USER_HEADER"></DIV>
			<DIV CLASS="INFO">
				<DIV CLASS="ICON_NAME">
					<IMG ID="USER_ICON">
					<SPAN ID="USER_NAME">るみ㌨Да</SPAN>
				</DIV>
				<DIV CLASS="UID" ID="USER_ID"></DIV>
				<DIV CLASS="DESCRIPTION" ID="USER_DESCRIPTION">うんこ</DIV>
			</DIV>
		</DIV>
	</BODY>

	<SCRIPT SRC="https://cdn.rumia.me/LIB/htmlspecialchars.js?V=LATEST"></SCRIPT>
		<SCRIPT>
		let EL = {
			ARCHIVE_LIST: document.getElementById("ARCHIVE_LIST")
		};

		window.addEventListener("load", async (e)=>{
			const url_param = new URLSearchParams(window.location.search);
			if (url_param.get("ARCHIVE") == null) return;
			const ID = url_param.get("ARCHIVE");

			let ajax = await fetch("/api/UserArchive?ID=" + ID);
			const result = await ajax.json();
			if (result.STATUS) {
				if (result.BEFORE != null) {
					document.getElementById("BEFORE_ARCHIVE").href = `./user_archive?ARCHIVE=${result.BEFORE}`;
				} else {
					document.getElementById("BEFORE_ARCHIVE").remove();
				}

				if (result.AFTER != null) {
					document.getElementById("AFTER_ARCHIVE").href = `./user_archive?ARCHIVE=${result.AFTER}`;
				} else {
					document.getElementById("AFTER_ARCHIVE").remove();
				}

				document.getElementById("ARCHIVE_DATE").innerText = result.USER.DATE;

				document.getElementById("USER_HEADER").style.backgroundImage = `url('${result.USER.HEADER_ARCHIVE}')`;
				document.getElementById("USER_ICON").src = result.USER.ICON_ARCHIVE;
				document.getElementById("USER_NAME").innerText = result.USER.NAME;
				document.getElementById("USER_ID").innerHTML = `@${htmlspecialchars(result.USER.PREFERRED_UID)}@<A HREF="./instance_archive?ARCHIVE=${result.INSTANCE}">${htmlspecialchars(result.HOST)}<A>`;
				document.getElementById("USER_DESCRIPTION").innerText = result.USER.DESCRIPTION;
			}
		});
	</SCRIPT>
</HTML>
